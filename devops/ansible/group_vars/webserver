#
# General Application Settings
#

#
# Role: chusiang.php7
#
yum_php_version: "70u"
yum_php_packages:
  - php{{ yum_php_version }}-cli
  - php{{ yum_php_version }}-common
  - php{{ yum_php_version }}-fpm
  - php{{ yum_php_version }}-fpm-nginx
  - php{{ yum_php_version }}-json
  - php{{ yum_php_version }}-mysqlnd
  - php{{ yum_php_version }}-opcache
  - php{{ yum_php_version }}-pdo
  - php{{ yum_php_version }}-mbstring
  - php{{ yum_php_version }}-gd
  - php{{ yum_php_version }}-xml

php_disable_functions: "exec,passthru,shell_exec,system,popen"
php_allow_url_fopen: "On"

#
# Role: ontic.account
# https://github.com/ontic/ansible-role-account/tree/master/docs
# http://docs.ansible.com/ansible/latest/playbooks_lookups.html#the-password-lookup
#
app_name: chappress
app_user: deploy
app_user_pw_path: "/tmp/ansible-{{ app_name }}-{{ app_user }}-{{inventory_hostname}}-pw.txt"
app_remote_path: "/var/www/{{ app_name }}"

account_groups:
  - name: "{{ app_user }}"
    system: yes
account_users:
  - name: "{{ app_user }}"
    createhome: yes
    sudoer: yes
    group: "{{ app_user }}"
    password: "{{ lookup('password', '{{ app_user_pw_path }} length=16 encrypt=md5_crypt') }}"
    files:
      - path: '.ssh'
        mode: '0700'
        state: 'directory'

#
# Role: geerlingguy.firewall
#
firewall_allowed_tcp_ports:
  - "22"
  - "80"
  - "443"

#
# Role: geerlingguy.nginx
#
# This is the default Red Hat setting from the role.

nginx_remove_default_vhost: true

#
# Role: jdauphant.ssl-certs
#
ssl_certs_country: "US"
ssl_certs_locality: "California"
ssl_certs_organization: "Chapman University"
ssl_certs_state: "California"
ssl_certs_common_name: "chappress-staging"
ssl_certs_days: "365"
ssl_certs_fields: "/C={{ssl_certs_country}}/ST={{ssl_certs_state}}/L={{ssl_certs_locality}}/O={{ssl_certs_organization}}/CN={{ssl_certs_common_name}}"

ssl_certs_path: "/etc/ssl"
ssl_certs_path_owner: "wimops"
ssl_certs_path_group: "webadmin"
ssl_certs_privkey_path: "/etc/ssl/private/chappress-staging.key"
ssl_certs_cert_path: "/etc/ssl/certs/chappress-staging.pem"
ssl_certs_csr_path: "/etc/ssl/certs/chappress-staging.csr"
ssl_certs_dhparam_path: "/etc/ssl/certs/dhparam.pem"
ssl_certs_mode: "0700"
ssl_certs_force_replace: yes

ssl_certs_local_privkey_path: "{{inventory_dir|default(playbook_dir)}}/files/ssl/chappress-staging.key"
ssl_certs_local_cert_path: "{{inventory_dir|default(playbook_dir)}}/files/ssl/chappress-staging.pem"
ssl_certs_local_privkey_data: ""
ssl_certs_local_cert_data: ""

ssl_certs_generate_self_signed: true
ssl_certs_key_size: "2048"
ssl_certs_generate_dh_param: true
ssl_certs_dhparam_size: "2048"